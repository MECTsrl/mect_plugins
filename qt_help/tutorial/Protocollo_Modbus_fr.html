
<html>
	<head>
	  <meta http-equiv="content-type" content="text/html; charset=windows-1252"/>
	   <title>Protocole Modbus</title>
	   <style type="text/css">
		@page { size: 21.59cm 27.94cm; margin-right: 2cm; margin-top: 2.5cm; margin-bottom: 1.5cm }
		p { margin-bottom: 0.21cm; direction: ltr; color: #000000; orphans: 0; widows: 0 }
		p.western { font-family: "Arial", "Times New Roman", serif; font-size: 10pt; so-language: it-IT }
		h3.western { font-family: "Liberation Sans", "Arial", sans-serif; so-language: it-IT }
		a:link { color: #0000ff }
		a.cjk:visited { so-language: zh-CN }
	</style>
	</head>	
	<body>
		<h3 class="western">Protocole Modbus</h3>
	<p class="western">Les protocoles Modbus/TCP et Modbus/RTU peuvent être utilisés dans les appareils Mect:</p>
	<ul>
		<li/>
		<p class="western">en mode Maître (Client) pour accéder aux registres sur des appareils externes connectés, respectivement, via TCP/IP ou via série (RS485/RS422).</p>
		<li/>
		<p class="western">en mode serveur (esclave) pour mettre à disposition les registres à des dispositifs externes connectés comme ci-dessus.</p>
	</ul>
	<p class="western">Dans l'éditeur de la Crosstable:</p>
	<table width="500" cellpadding="9" cellspacing="0">
			<col width="250">
			<col width="250">
			<col width="250">
			<thead>
				<tr valign="top">
					<th width="250" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
						<p class="western"></p>
					</th>
					<th width="250" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
						<p class="western">Modbus TCP</p>
					</th>
					<th width="250" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 0px solid #000000; border-right: 1px solid #000000; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
						<p class="western">Modbus RTU</p>
					</th>
				</tr>
			</thead>
			<tbody>
				<tr valign="top">
					<td width="250" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
						<p class="western"><strong>Master (Client)</strong></p>
					</td>
					<td width="250"  style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
					<p class="western"><strong>TCP</strong></p>
					</td>
					<td width="250"  style="border-top: none; border-bottom: 1px solid #000000; border-left: 0px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
					<p class="western"><strong>RTU</strong></p>
					</td>
				</tr>
				<tr valign="top">
					<td width="250" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
						<p class="western"><strong>Server (Slave)</strong></p>
					</td>
					<td width="250"  style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
					<p class="western"><strong>TCP_SRV</strong></p>
					</td>
					<td width="250"  style="border-top: none; border-bottom: 1px solid #000000; border-left: 0px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
					<p class="western"><strong>RTU_SRV</strong></p>
					</td>
				</tr>
			</tbody>
		</table>
	<p class="western">L'utilisation des protocoles Modbus est très simple car il n'est pas nécessaire de faire des appels de fonction pour lire les registres via Modbus. Les registres Modbus doivent être associés à des variables dans le “Editeur de la Crosstable” et on spécifie une “période de lecture” (Read period): le système met alors automatiquement à jour les variables, en fonction de la période spécifiée et en gérant les éventuelles erreurs de communication. De plus, l'écriture des variables (à la fois à partir de l'IHM et de l'automate programmable PLC) entraîne l'écriture immédiate du registre correspondant via Modbus.</p>	
	<p class="western"><u>Cependant, il est important de préciser des “périodes de lecture” correctes</u>.</p>	
	<p class="western"><u>S’ils sont trop courtes ou s’il y a trop de registres sur le même appareil alors le système ne pourra pas mettre à jour toutes les variables</u>.</p>
	<p class="western"><u>Pour faciliter le choix, on recommande d’utiliser l’onglet &ldquo;<font color="#0000ff"><u><a class="western" href="Timings_fr.html">Timings</a></u></font>&rdquo; dans l’éditeur de la Crosstable</u>.</p>
	
	<p class="western">Dans le champ (Register), vous devez signaler le décalage(offset) du registre (parfois appelé index ou adresse ou numéro). N'oubliez pas que les registres Modbus sont de 16 bits, donc:</p>
	<ul>
		<li/>
		<p class="western">si (Type) est 8 ou 16 (par exemple BIT, INT, ...) alors le décalage du registre suivant est "+1".</p>
		<li/>
		<p class="western">si (Type) est à 32 bits (par exemple DWORD_BIT, REAL, UDINT, DINT, ...) alors le décalage du registre suivant est "+2".</p>
	</ul>
	<p class="western">Aussi:</p>
	<ul>
		<li/>
		<p class="western">si la variable est avec (Type) BIT, le système utilisera automatiquement les fonctions:</p>
			<ul>
				<li/>
				<p class="western">"0x01 Read Coils"</p>
				<li/>
				<p class="western">"0x05 Write Single Coil"</p>
				<li/>
				<p class="western">"0x15 Write Multiple Coils"</p>
			</ul>
		<li/>
		<p class="western">si vous avez spécifié “Input register”, le système utilisera automatiquement la fonction “0x04 Read Input Registers”.</p>
		<li/>
		<p class="western">sinon le système utilisera automatiquement les fonctions:</p> 
		<ul>
			<li/>
			<p class="western">"0x03 Read Holding Register"</p>
			<li/>
			<p class="western">"0x06 Write Single Register"</p>
			<li/>
			<p class="western">"0x10 Write Multiple Registers"</p>
		</ul>		
	</ul>
	<br/>
	<p class="western"><strong><u>Définition de la variable quand le plc est Maître/Client</u>:</strong></p>
	<ul>
		<li/>
		<p class="western">RTU</p>
			<ul>
			<li/>
			<p class="western">(Priority) - 2 (ligne directrice, non obligatoire).</p>
			<li/>
			<p class="western">(Protocol) - RTU.</p>
			<li/>
			<p class="western">(Node ID) - de 1 à 247.</p>
			<li/>
			<p class="western">(Register) - de 0 à 65535.</p>
			</ul>
		<li/>
		<p class="western">TCP</p>
			<ul>
			<li/>
			<p class="western">(Priority) - 3 (ligne directrice, non obligatoire).</p>
			<li/>
			<p class="western">(Protocol) - TCP.</p>
			<li/>
			<p class="western">(IP Address) - x.x.x.x (server/slave).</p>
			<li/>
			<p class="western">(Port) - 502.</p>
			<li/>
			<p class="western">(Node ID) - de 0 à 255.</p>
			<li/>
			<p class="western">(Register) - de 0 à 65535.</p>
			</ul>
	</ul>
	<table width="600" cellpadding="8" cellspacing="0">
			<col width="300">
			<col width="300">
			<thead>
				<tr valign="top">
					<th width="300" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
						<p class="western">Maître / client = TPAC (à la fois TCP et RTU)</p>
					</th>
					<th width="300" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
						<p class="western">Serveur / esclave = dispositif externe</p>
					</th>					
				</tr>
			</thead>
			<tbody>
				<tr valign="top">
					<td width="300" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
						<p class="western">Type: <strong>BIT</strong></p>
					</td>
					<td width="300"  style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
					<p class="western">"0x01 Read Coils"<br> "0x05 Write Single Coil"<br> "0x15 Write Multiple Coils"</p>
					</td>
				</tr>
				<tr valign="top">
					<td width="300" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
						<p class="western">Type: <strong>tous les autres</strong></p>
					</td>
					<td width="300"  style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
					<p class="western">“0x03 Read Holding Register”<br> “0x06 Write Single Register”<br> “0x10 Write Multiple Registers”</p>
					</td>
				</tr>
				<tr valign="top">
					<td width="300" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
						<p class="western"><strong>Registre d’entrée</strong></p>
					</td>
					<td width="300"  style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
					<p class="western">“0x04 Read Input Registers”</p>
					</td>
				</tr>
			</tbody>
		</table>
		<br/>
		<p class="western"><strong><u>Definition de la variable quand le plc est Serveur/Esclave</u>:</strong></p>
	<ul>
		<li/>
		<p class="western">RTU_SRV</p>
			<ul>
			<li/>
			<p class="western">(Priority) - 2 (ligne directrice, non obligatoire).</p>
			<li/>
			<p class="western">(Type) - n’accepte pas de BIT, vous pouvez utiliser  WORD_BIT.</p>
			<li/>
			<p class="western">(Protocol) - RTU_SRV.</p>
			<li/>
			<p class="western">(Node ID) - de 1 à 247.</p>
			<li/>
			<p class="western">(Register) - de 0 à <strong>4095</strong>.</p>
			<li/>
			<p class="western">(Behavior) - RW si la logique plc doit écrire la variable, RO si elle n'est écrite que par des dispositifs externes.</p>
			</ul>
		<li/>
		<p class="western">TCP_SRV</p>
			<ul>
			<li/>
			<p class="western">(Priority) - 3 (ligne directrice, non obligatoire).</p>
			<li/>
			<p class="western">(Type) - n’accepte pas de BIT, vous pouvez utiliser WORD_BIT.</p>
			<li/>
			<p class="western">(Protocol) - TCP_SRV.</p>
			<li/>
			<p class="western">(IP Address) - 0.0.0.0</p>
			<li/>
			<p class="western">(Port) - 502.</p>
			<li/>
			<p class="western">(Node ID) - 1 (n’accepte que 1).</p>
			<li/>
			<p class="western">(Register) - de 0 à <strong>4095</strong>.</p>
			<li/>
			<p class="western">(Behavior) - RW si la logique plc doit écrire la variable, RO si elle n'est écrite que par des dispositifs externes.</p>
			</ul>
	</ul>
	<table width="600" cellpadding="8" cellspacing="0">
			<col width="300">
			<col width="300">
			<thead>
				<tr valign="top">
					<th width="300" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
						<p class="western">Maître / client = dispositif externe</p>
					</th>
					<th width="300" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
						<p class="western">Server / slave = TPAC<br>(à la fois TCP_SRV et RTU_SRV)</p>
					</th>					
				</tr>
			</thead>
			<tbody>
				<tr valign="top">
					<td width="300" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
						<p class="western">"0x01 Read Coils"<br> "0x05 Write Single Coil"<br> "0x15 Write Multiple Coils"</p>
					</td>
					<td width="300"  style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
					<p class="western">NON PERMIS</p>
					</td>
				</tr>
				<tr valign="top">
					<td width="300" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
						<p class="western">“0x03 Read Holding Register”<br> “0x06 Write Single Register”<br> “0x10 Write Multiple Registers”</p>
					</td>
					<td width="300"  style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
					<p class="western">Type: <strong>tous sauf BIT</strong></p>
					</td>
				</tr>
				<tr valign="top">
					<td width="300" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
						<p class="western">“0x04 Read Input Registers”</p>
					</td>
					<td width="300"  style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" align="center">
					<p class="western">NON PERMIS</p>
					</td>
				</tr>
			</tbody>
		</table>
	<br/>
	<p class="western"><strong><u>CONFIGURATION MODBUS</u>:</strong></p>
	<p class="western">Après avoir saisi les variables avec les registres Modbus dans la Crosstable, vous devez vérifier les temps de lecture des bus (voir chapitre &ldquo;<font color="#0000ff"><u><a class="western" href="Timings_fr.html">Timings</a></u></font>&rdquo;). </p>
	<p class="western">Le champ “Priorité” (2) et (3) associe un temps de lecture aux variables qui ont cette priorité spécifique . Pour modifier ces temps, allez dans l' &ldquo;<font color="#0000ff"><u><a class="western" href="System_Editor.html">Éditeur de système</a></u></font>&rdquo;, sous “Système” -> “Période de lecture 2 [ms]” et  “Période de lecture 3 [ms]”.  </p>
	<p class="western">Pour modifier “Baudrate”, “Timeout” et “Silence” allez dans l'Éditeur de système -> “SERIAL PORT x” </p>
	<br/>
	</body>
</html>